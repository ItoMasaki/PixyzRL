<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.5">
<title>pixyzrl.environments.env API documentation</title>
<meta name="description" content="Single Gym environment wrapper.">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pixyzrl.environments.env</code></h1>
</header>
<section id="section-intro">
<p>Single Gym environment wrapper.</p>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pixyzrl.environments.env.BaseEnv"><code class="flex name class">
<span>class <span class="ident">BaseEnv</span></span>
<span>(</span><span>env_name: str, num_envs: int = 1, seed: int = 42)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BaseEnv(ABC):
    &#34;&#34;&#34;Base class for RL environments.

    This class defines the interface for RL environments.
    &#34;&#34;&#34;

    def __init__(self, env_name: str, num_envs: int = 1, seed: int = 42) -&gt; None:
        &#34;&#34;&#34;
        Initialize the environment.
        :param env_name: Name of the gym environment.
        :param num_envs: Number of environments (1 for single, &gt;1 for vectorized).
        :param seed: Random seed for reproducibility.
        &#34;&#34;&#34;
        self.env_name = env_name
        self.seed = seed

        self._observation_space = Space()
        self._action_space = Space()
        self._is_discrete = False
        self._num_envs = num_envs
        self._env = None
        self._render_mode = &#34;rgb_array&#34;

    @abstractmethod
    def reset(self, **kwargs: dict[str, Any]) -&gt; tuple[torch.Tensor, dict[str, Any]]:
        &#34;&#34;&#34;Reset the environment.&#34;&#34;&#34;
        ...

    @abstractmethod
    def step(self, action: Any) -&gt; tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, dict[str, Any]]:
        &#34;&#34;&#34;Step through the environment.&#34;&#34;&#34;
        ...

    @abstractmethod
    def close(self) -&gt; None:
        &#34;&#34;&#34;Close the environment.&#34;&#34;&#34;
        ...

    @abstractmethod
    def render(self) -&gt; None:
        &#34;&#34;&#34;Render the environment.&#34;&#34;&#34;
        ...

    @property
    def num_envs(self) -&gt; int:
        &#34;&#34;&#34;Return the number of environments.&#34;&#34;&#34;
        return self._num_envs

    @property
    def observation_space(self) -&gt; Space[Any]:
        &#34;&#34;&#34;Return observation space.&#34;&#34;&#34;
        return self._observation_space

    @property
    def action_space(self) -&gt; Space[Any]:
        &#34;&#34;&#34;Return action space.&#34;&#34;&#34;
        return self._action_space

    @property
    def is_discrete(self) -&gt; bool:
        &#34;&#34;&#34;Return whether the action space is discrete.&#34;&#34;&#34;
        return self._is_discrete

    @property
    def env(self) -&gt; gym.Env[Any, Any] | None:
        &#34;&#34;&#34;Return the gym environment.&#34;&#34;&#34;
        return self._env

    @property
    def render_mode(self) -&gt; str:
        &#34;&#34;&#34;Return the rendering mode.&#34;&#34;&#34;
        return self._render_mode</code></pre>
</details>
<div class="desc"><p>Base class for RL environments.</p>
<p>This class defines the interface for RL environments.</p>
<p>Initialize the environment.
:param env_name: Name of the gym environment.
:param num_envs: Number of environments (1 for single, &gt;1 for vectorized).
:param seed: Random seed for reproducibility.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="pixyzrl.environments.env.Env" href="#pixyzrl.environments.env.Env">Env</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pixyzrl.environments.env.BaseEnv.action_space"><code class="name">prop <span class="ident">action_space</span> : gymnasium.spaces.space.Space[typing.Any]</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def action_space(self) -&gt; Space[Any]:
    &#34;&#34;&#34;Return action space.&#34;&#34;&#34;
    return self._action_space</code></pre>
</details>
<div class="desc"><p>Return action space.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BaseEnv.env"><code class="name">prop <span class="ident">env</span> : gymnasium.core.Env[typing.Any, typing.Any] | None</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def env(self) -&gt; gym.Env[Any, Any] | None:
    &#34;&#34;&#34;Return the gym environment.&#34;&#34;&#34;
    return self._env</code></pre>
</details>
<div class="desc"><p>Return the gym environment.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BaseEnv.is_discrete"><code class="name">prop <span class="ident">is_discrete</span> : bool</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def is_discrete(self) -&gt; bool:
    &#34;&#34;&#34;Return whether the action space is discrete.&#34;&#34;&#34;
    return self._is_discrete</code></pre>
</details>
<div class="desc"><p>Return whether the action space is discrete.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BaseEnv.num_envs"><code class="name">prop <span class="ident">num_envs</span> : int</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_envs(self) -&gt; int:
    &#34;&#34;&#34;Return the number of environments.&#34;&#34;&#34;
    return self._num_envs</code></pre>
</details>
<div class="desc"><p>Return the number of environments.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BaseEnv.observation_space"><code class="name">prop <span class="ident">observation_space</span> : gymnasium.spaces.space.Space[typing.Any]</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def observation_space(self) -&gt; Space[Any]:
    &#34;&#34;&#34;Return observation space.&#34;&#34;&#34;
    return self._observation_space</code></pre>
</details>
<div class="desc"><p>Return observation space.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BaseEnv.render_mode"><code class="name">prop <span class="ident">render_mode</span> : str</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def render_mode(self) -&gt; str:
    &#34;&#34;&#34;Return the rendering mode.&#34;&#34;&#34;
    return self._render_mode</code></pre>
</details>
<div class="desc"><p>Return the rendering mode.</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pixyzrl.environments.env.BaseEnv.close"><code class="name flex">
<span>def <span class="ident">close</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abstractmethod
def close(self) -&gt; None:
    &#34;&#34;&#34;Close the environment.&#34;&#34;&#34;
    ...</code></pre>
</details>
<div class="desc"><p>Close the environment.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BaseEnv.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abstractmethod
def render(self) -&gt; None:
    &#34;&#34;&#34;Render the environment.&#34;&#34;&#34;
    ...</code></pre>
</details>
<div class="desc"><p>Render the environment.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BaseEnv.reset"><code class="name flex">
<span>def <span class="ident">reset</span></span>(<span>self, **kwargs: dict[str, typing.Any]) ‑> tuple[torch.Tensor, dict[str, typing.Any]]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abstractmethod
def reset(self, **kwargs: dict[str, Any]) -&gt; tuple[torch.Tensor, dict[str, Any]]:
    &#34;&#34;&#34;Reset the environment.&#34;&#34;&#34;
    ...</code></pre>
</details>
<div class="desc"><p>Reset the environment.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BaseEnv.step"><code class="name flex">
<span>def <span class="ident">step</span></span>(<span>self, action: Any) ‑> tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, dict[str, typing.Any]]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abstractmethod
def step(self, action: Any) -&gt; tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, dict[str, Any]]:
    &#34;&#34;&#34;Step through the environment.&#34;&#34;&#34;
    ...</code></pre>
</details>
<div class="desc"><p>Step through the environment.</p></div>
</dd>
</dl>
</dd>
<dt id="pixyzrl.environments.env.BipedalRobotEnv"><code class="flex name class">
<span>class <span class="ident">BipedalRobotEnv</span></span>
<span>(</span><span>render_mode: str = 'human')</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BipedalRobotEnv(gym.Env[Any, Any]):
    metadata = {&#34;render.modes&#34;: [&#34;human&#34;, &#34;rgb_array&#34;], &#34;video.frames_per_second&#34;: 50}

    def __init__(self, render_mode: str = &#34;human&#34;):
        super().__init__()

        self.render_mode = render_mode

        if self.render_mode == &#34;human&#34;:
            self.client_id = p.connect(p.GUI)
        else:
            self.client_id = p.connect(p.DIRECT)

        p.setAdditionalSearchPath(pd.getDataPath())
        self._setup_simulation()

        self.lower_upper = [
            {&#34;idx&#34;: 1, &#34;lower&#34;: -0.26017, &#34;upper&#34;: 0.26017},
            {&#34;idx&#34;: 2, &#34;lower&#34;: -0.26017, &#34;upper&#34;: 0.26017},
            {&#34;idx&#34;: 5, &#34;lower&#34;: -0.13, &#34;upper&#34;: 0.13},
            {&#34;idx&#34;: 6, &#34;lower&#34;: -0.13, &#34;upper&#34;: 0.13},
            {&#34;idx&#34;: 7, &#34;lower&#34;: -0.165, &#34;upper&#34;: 0.365},
            {&#34;idx&#34;: 8, &#34;lower&#34;: -0.165, &#34;upper&#34;: 0.365},
            {&#34;idx&#34;: 11, &#34;lower&#34;: -0.065, &#34;upper&#34;: 0.565},
            {&#34;idx&#34;: 12, &#34;lower&#34;: -0.065, &#34;upper&#34;: 0.565},
            {&#34;idx&#34;: 15, &#34;lower&#34;: -0.465, &#34;upper&#34;: 0.165},
            {&#34;idx&#34;: 16, &#34;lower&#34;: -0.465, &#34;upper&#34;: 0.165},
        ]

        self.action_space = spaces.Box(low=-1.0, high=1.0, shape=(len(self.lower_upper),), dtype=np.float32)
        self.observation_space = spaces.Box(low=-np.inf, high=np.inf, shape=(p.getNumJoints(self.botId) + 1,), dtype=np.float32)
        self.step_counter = 0
        self.max_steps = 200

    def _setup_simulation(self) -&gt; None:
        p.setGravity(0, 0, -9.8, physicsClientId=self.client_id)
        p.setTimeStep(1 / 50, physicsClientId=self.client_id)

        # Create Terrain
        numHeightfieldRows = 256
        numHeightfieldColumns = 256
        heightfieldData = [random.uniform(0, 0.0) for _ in range(numHeightfieldRows * numHeightfieldColumns)]
        terrainShape = p.createCollisionShape(shapeType=p.GEOM_HEIGHTFIELD, meshScale=[0.1, 0.1, 1], heightfieldTextureScaling=numHeightfieldRows, heightfieldData=heightfieldData, numHeightfieldRows=numHeightfieldRows, numHeightfieldColumns=numHeightfieldColumns, physicsClientId=self.client_id)
        self.terrain = p.createMultiBody(0, terrainShape, physicsClientId=self.client_id)
        p.resetBasePositionAndOrientation(self.terrain, [0, 0, 0], [0, 0, 0, 1], physicsClientId=self.client_id)

        # Load Robot
        cubeStartPos = [0, 0, 0.57]
        cubeStartOrientation = p.getQuaternionFromEuler([0.0, 0, 0])
        self.botId = p.loadURDF(&#34;/Users/itomasaki/Desktop/PixyzRL/examples/mybot.urdf&#34;, cubeStartPos, cubeStartOrientation, physicsClientId=self.client_id)

        for joint in range(p.getNumJoints(self.botId)):
            p.setJointMotorControl2(self.botId, joint, p.POSITION_CONTROL, force=15.0, physicsClientId=self.client_id)

    def step(self, action: NDArray[np.float32]) -&gt; tuple[Any, SupportsFloat, bool, bool, dict[str, Any]]:
        # Action [-1, 1] -&gt; [-0.165, 0.365]

        for joint_idx, joint_action in enumerate(action):
            p.setJointMotorControl2(self.botId, self.lower_upper[joint_idx][&#34;idx&#34;], p.VELOCITY_CONTROL, targetVelocity=joint_action, force=100.0)

        p.stepSimulation(physicsClientId=self.client_id)

        body_height = p.getLinkState(self.botId, 1, physicsClientId=self.client_id)[0][2]
        obs = self._get_observation()

        reward = 0.1 if (body_height &gt; 0.455) and (body_height &lt; 0.475) else -0.1  # Reward for staying high (simplified)
        reward = -p.getLinkState(self.botId, 0, physicsClientId=self.client_id)[0][1]

        collision = p.getContactPoints(self.botId, self.terrain, -1, -1, physicsClientId=self.client_id)
        if len(collision) &gt; 0:
            reward = -3
        done = len(collision) &gt; 0

        if self.step_counter &gt;= self.max_steps:
            done = True
        self.step_counter += 1

        info = {}

        reward = np.array([reward], dtype=np.float32)
        done = np.array([done], dtype=bool)

        return obs, reward, done, done, info

    def reset(self, *, seed: int | None = None, options: dict[str, Any] | None = None) -&gt; tuple[NDArray[np.float32], dict[str, Any]]:
        super().reset(seed=seed, options=options)
        p.resetBasePositionAndOrientation(self.botId, [0, 0, 0.57], [0, 0, 0, 1], physicsClientId=self.client_id)
        for joint_idx in range(p.getNumJoints(self.botId)):
            p.resetJointState(self.botId, joint_idx, 0, physicsClientId=self.client_id)
        self.step_counter = 0

        return self._get_observation(), {}

    def _get_observation(self) -&gt; NDArray[Any]:
        joint_positions = [p.getJointState(self.botId, self.lower_upper[joint_idx][&#34;idx&#34;], physicsClientId=self.client_id)[0] for joint_idx in range(len(self.lower_upper))]
        base_link_quat = p.getLinkState(self.botId, 0, physicsClientId=self.client_id)[1]
        return np.array([*joint_positions, *base_link_quat], dtype=np.float32)

    def render(self, mode: str = &#34;human&#34;) -&gt; Any:
        if mode == &#34;rgb_array&#34;:
            width, height, _, _, _, _ = p.getCameraImage(320, 240, physicsClientId=self.client_id)
            return np.array(width).reshape((240, 320, 3))
        return None

    def close(self) -&gt; None:
        p.disconnect(self.client_id)</code></pre>
</details>
<div class="desc"><p>The main Gymnasium class for implementing Reinforcement Learning Agents environments.</p>
<p>The class encapsulates an environment with arbitrary behind-the-scenes dynamics through the :meth:<code>step</code> and :meth:<code>reset</code> functions.
An environment can be partially or fully observed by single agents. For multi-agent environments, see PettingZoo.</p>
<p>The main API methods that users of this class need to know are:</p>
<ul>
<li>:meth:<code>step</code> - Updates an environment with actions returning the next agent observation, the reward for taking that actions,
if the environment has terminated or truncated due to the latest action and information from the environment about the step, i.e. metrics, debug info.</li>
<li>:meth:<code>reset</code> - Resets the environment to an initial state, required before calling step.
Returns the first agent observation for an episode and information, i.e. metrics, debug info.</li>
<li>:meth:<code>render</code> - Renders the environments to help visualise what the agent see, examples modes are "human", "rgb_array", "ansi" for text.</li>
<li>:meth:<code>close</code> - Closes the environment, important when external software is used, i.e. pygame for rendering, databases</li>
</ul>
<p>Environments have additional attributes for users to understand the implementation</p>
<ul>
<li>:attr:<code>action_space</code> - The Space object corresponding to valid actions, all valid actions should be contained within the space.</li>
<li>:attr:<code>observation_space</code> - The Space object corresponding to valid observations, all valid observations should be contained within the space.</li>
<li>:attr:<code>spec</code> - An environment spec that contains the information used to initialize the environment from :meth:<code>gymnasium.make</code></li>
<li>:attr:<code>metadata</code> - The metadata of the environment, e.g. <code>{"render_modes": ["rgb_array", "human"], "render_fps": 30}</code>. For Jax or Torch, this can be indicated to users with <code>"jax"=True</code> or <code>"torch"=True</code>.</li>
<li>:attr:<code>np_random</code> - The random number generator for the environment. This is automatically assigned during
<code>super().reset(seed=seed)</code> and when assessing :attr:<code>np_random</code>.</li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">Seealso:&ensp;For modifying or extending environments use the :class:<code>gymnasium.Wrapper</code> class</p>
</div>
<h2 id="note">Note</h2>
<p>To get reproducible sampling of actions, a seed can be set with <code>env.action_space.seed(123)</code>.</p>
<h2 id="note_1">Note</h2>
<p>For strict type checking (e.g. mypy or pyright), :class:<code><a title="pixyzrl.environments.env.Env" href="#pixyzrl.environments.env.Env">Env</a></code> is a generic class with two parameterized types: <code>ObsType</code> and <code>ActType</code>.
The <code>ObsType</code> and <code>ActType</code> are the expected types of the observations and actions used in :meth:<code>reset</code> and :meth:<code>step</code>.
The environment's :attr:<code>observation_space</code> and :attr:<code>action_space</code> should have type <code>Space[ObsType]</code> and <code>Space[ActType]</code>,
see a space's implementation to find its parameterized type.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>gymnasium.core.Env</li>
<li>typing.Generic</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pixyzrl.environments.env.BipedalRobotEnv.metadata"><code class="name">var <span class="ident">metadata</span></code></dt>
<dd>
<div class="desc"><p>The type of the None singleton.</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pixyzrl.environments.env.BipedalRobotEnv.close"><code class="name flex">
<span>def <span class="ident">close</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def close(self) -&gt; None:
    p.disconnect(self.client_id)</code></pre>
</details>
<div class="desc"><p>After the user has finished using the environment, close contains the code necessary to "clean up" the environment.</p>
<p>This is critical for closing rendering windows, database or HTTP connections.
Calling <code>close</code> on an already closed environment has no effect and won't raise an error.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BipedalRobotEnv.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self, mode: str = 'human') ‑> Any</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def render(self, mode: str = &#34;human&#34;) -&gt; Any:
    if mode == &#34;rgb_array&#34;:
        width, height, _, _, _, _ = p.getCameraImage(320, 240, physicsClientId=self.client_id)
        return np.array(width).reshape((240, 320, 3))
    return None</code></pre>
</details>
<div class="desc"><p>Compute the render frames as specified by :attr:<code>render_mode</code> during the initialization of the environment.</p>
<p>The environment's :attr:<code>metadata</code> render modes (<code>env.metadata["render_modes"]</code>) should contain the possible
ways to implement the render modes. In addition, list versions for most render modes is achieved through
<code>gymnasium.make</code> which automatically applies a wrapper to collect rendered frames.</p>
<h2 id="note">Note</h2>
<p>As the :attr:<code>render_mode</code> is known during <code>__init__</code>, the objects used to render the environment state
should be initialised in <code>__init__</code>.</p>
<p>By convention, if the :attr:<code>render_mode</code> is:</p>
<ul>
<li>None (default): no render is computed.</li>
<li>"human": The environment is continuously rendered in the current display or terminal, usually for human consumption.
This rendering should occur during :meth:<code>step</code> and :meth:<code>render</code> doesn't need to be called. Returns <code>None</code>.</li>
<li>"rgb_array": Return a single frame representing the current state of the environment.
A frame is a <code>np.ndarray</code> with shape <code>(x, y, 3)</code> representing RGB values for an x-by-y pixel image.</li>
<li>"ansi": Return a strings (<code>str</code>) or <code>StringIO.StringIO</code> containing a terminal-style text representation
for each time step. The text can include newlines and ANSI escape sequences (e.g. for colors).</li>
<li>"rgb_array_list" and "ansi_list": List based version of render modes are possible (except Human) through the
wrapper, :py:class:<code>gymnasium.wrappers.RenderCollection</code> that is automatically applied during <code>gymnasium.make(..., render_mode="rgb_array_list")</code>.
The frames collected are popped after :meth:<code>render</code> is called or :meth:<code>reset</code>.</li>
</ul>
<h2 id="note_1">Note</h2>
<p>Make sure that your class's :attr:<code>metadata</code> <code>"render_modes"</code> key includes the list of supported modes.</p>
<div class="admonition versionchanged">
<p class="admonition-title">Changed in version:&ensp;0.25.0</p>
<p>The render function was changed to no longer accept parameters, rather these parameters should be specified
in the environment initialised, i.e., <code>gymnasium.make("CartPole-v1", render_mode="human")</code></p>
</div></div>
</dd>
<dt id="pixyzrl.environments.env.BipedalRobotEnv.reset"><code class="name flex">
<span>def <span class="ident">reset</span></span>(<span>self, *, seed: int | None = None, options: dict[str, typing.Any] | None = None) ‑> tuple[numpy.ndarray[tuple[int, ...], numpy.dtype[numpy.float32]], dict[str, typing.Any]]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def reset(self, *, seed: int | None = None, options: dict[str, Any] | None = None) -&gt; tuple[NDArray[np.float32], dict[str, Any]]:
    super().reset(seed=seed, options=options)
    p.resetBasePositionAndOrientation(self.botId, [0, 0, 0.57], [0, 0, 0, 1], physicsClientId=self.client_id)
    for joint_idx in range(p.getNumJoints(self.botId)):
        p.resetJointState(self.botId, joint_idx, 0, physicsClientId=self.client_id)
    self.step_counter = 0

    return self._get_observation(), {}</code></pre>
</details>
<div class="desc"><p>Resets the environment to an initial internal state, returning an initial observation and info.</p>
<p>This method generates a new starting state often with some randomness to ensure that the agent explores the
state space and learns a generalised policy about the environment. This randomness can be controlled
with the <code>seed</code> parameter otherwise if the environment already has a random number generator and
:meth:<code>reset</code> is called with <code>seed=None</code>, the RNG is not reset.</p>
<p>Therefore, :meth:<code>reset</code> should (in the typical use case) be called with a seed right after initialization and then never again.</p>
<p>For Custom environments, the first line of :meth:<code>reset</code> should be <code>super().reset(seed=seed)</code> which implements
the seeding correctly.</p>
<div class="admonition versionchanged">
<p class="admonition-title">Changed in version:&ensp;v0.25</p>
<p>The <code>return_info</code> parameter was removed and now info is expected to be returned.</p>
</div>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>seed</code></strong> :&ensp;<code>optional int</code></dt>
<dd>The seed that is used to initialize the environment's PRNG (<code>np_random</code>) and
the read-only attribute <code>np_random_seed</code>.
If the environment does not already have a PRNG and <code>seed=None</code> (the default option) is passed,
a seed will be chosen from some source of entropy (e.g. timestamp or /dev/urandom).
However, if the environment already has a PRNG and <code>seed=None</code> is passed, the PRNG will <em>not</em> be reset
and the env's :attr:<code>np_random_seed</code> will <em>not</em> be altered.
If you pass an integer, the PRNG will be reset even if it already exists.
Usually, you want to pass an integer <em>right after the environment has been initialized and then never again</em>.
Please refer to the minimal example above to see this paradigm in action.</dd>
<dt><strong><code>options</code></strong> :&ensp;<code>optional dict</code></dt>
<dd>Additional information to specify how the environment is reset (optional,
depending on the specific environment)</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>observation (ObsType): Observation of the initial state. This will be an element of :attr:<code>observation_space</code>
(typically a numpy array) and is analogous to the observation returned by :meth:<code>step</code>.
info (dictionary):
This dictionary contains auxiliary information complementing <code>observation</code>. It should be analogous to
the <code>info</code> returned by :meth:<code>step</code>.</p></div>
</dd>
<dt id="pixyzrl.environments.env.BipedalRobotEnv.step"><code class="name flex">
<span>def <span class="ident">step</span></span>(<span>self, action: numpy.ndarray[tuple[int, ...], numpy.dtype[numpy.float32]]) ‑> tuple[typing.Any, typing.SupportsFloat, bool, bool, dict[str, typing.Any]]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def step(self, action: NDArray[np.float32]) -&gt; tuple[Any, SupportsFloat, bool, bool, dict[str, Any]]:
    # Action [-1, 1] -&gt; [-0.165, 0.365]

    for joint_idx, joint_action in enumerate(action):
        p.setJointMotorControl2(self.botId, self.lower_upper[joint_idx][&#34;idx&#34;], p.VELOCITY_CONTROL, targetVelocity=joint_action, force=100.0)

    p.stepSimulation(physicsClientId=self.client_id)

    body_height = p.getLinkState(self.botId, 1, physicsClientId=self.client_id)[0][2]
    obs = self._get_observation()

    reward = 0.1 if (body_height &gt; 0.455) and (body_height &lt; 0.475) else -0.1  # Reward for staying high (simplified)
    reward = -p.getLinkState(self.botId, 0, physicsClientId=self.client_id)[0][1]

    collision = p.getContactPoints(self.botId, self.terrain, -1, -1, physicsClientId=self.client_id)
    if len(collision) &gt; 0:
        reward = -3
    done = len(collision) &gt; 0

    if self.step_counter &gt;= self.max_steps:
        done = True
    self.step_counter += 1

    info = {}

    reward = np.array([reward], dtype=np.float32)
    done = np.array([done], dtype=bool)

    return obs, reward, done, done, info</code></pre>
</details>
<div class="desc"><p>Run one timestep of the environment's dynamics using the agent actions.</p>
<p>When the end of an episode is reached (<code>terminated or truncated</code>), it is necessary to call :meth:<code>reset</code> to
reset this environment's state for the next episode.</p>
<div class="admonition versionchanged">
<p class="admonition-title">Changed in version:&ensp;0.26</p>
<p>The Step API was changed removing <code>done</code> in favor of <code>terminated</code> and <code>truncated</code> to make it clearer
to users when the environment had terminated or truncated which is critical for reinforcement learning
bootstrapping algorithms.</p>
</div>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>action</code></strong> :&ensp;<code>ActType</code></dt>
<dd>an action provided by the agent to update the environment state.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt>observation (ObsType): An element of the environment's :attr:<code>observation_space</code> as the next observation due to the agent actions.</dt>
<dt>An example is a numpy array containing the positions and velocities of the pole in CartPole.</dt>
<dt>reward (SupportsFloat): The reward as a result of taking the action.</dt>
<dt>terminated (bool): Whether the agent reaches the terminal state (as defined under the MDP of the task)</dt>
<dt>which can be positive or negative. An example is reaching the goal state or moving into the lava from</dt>
<dt>the Sutton and Barto Gridworld. If true, the user needs to call :meth:<code>reset</code>.</dt>
<dt>truncated (bool): Whether the truncation condition outside the scope of the MDP is satisfied.</dt>
<dt>Typically, this is a timelimit, but could also be used to indicate an agent physically going out of bounds.</dt>
<dt>Can be used to end the episode prematurely before a terminal state is reached.</dt>
<dt>If true, the user needs to call :meth:<code>reset</code>.</dt>
<dt>info (dict): Contains auxiliary diagnostic information (helpful for debugging, learning, and logging).</dt>
<dt><code>
This might, for instance, contain</code></dt>
<dd>metrics that describe the agent's performance state, variables that are
hidden from observations, or individual reward terms that are combined to produce the total reward.
In OpenAI Gym &lt;v26, it contains "TimeLimit.truncated" to distinguish truncation and termination,
however this is deprecated in favour of returning terminated and truncated variables.</dd>
<dt>done (bool): (Deprecated) A boolean value for if the episode has ended, in which case further :meth:<code>step</code> calls will</dt>
<dt>return undefined results. This was removed in OpenAI Gym v26 in favor of terminated and truncated attributes.</dt>
<dt><code>
A done signal may be emitted for different reasons</code></dt>
<dd>Maybe the task underlying the environment was solved successfully,
a certain timelimit was exceeded, or the physics simulation has entered an invalid state.</dd>
</dl></div>
</dd>
</dl>
</dd>
<dt id="pixyzrl.environments.env.Env"><code class="flex name class">
<span>class <span class="ident">Env</span></span>
<span>(</span><span>env_name: str,<br>num_envs: int = 1,<br>action_var: str = 'a',<br>seed: int = 42,<br>render_mode: str = 'human')</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Env(BaseEnv):
    &#34;&#34;&#34;Standard single Gym environment wrapper.&#34;&#34;&#34;

    def __init__(self, env_name: str, num_envs: int = 1, action_var: str = &#34;a&#34;, seed: int = 42, render_mode: str = &#34;human&#34;) -&gt; None:
        &#34;&#34;&#34;
        Initialize the environment.

        Args:
            env_name (str): Name of the gym environment.
            action_var (str): Name of the action variable.
            seed (int): Random seed for reproducibility.
            render_mode (str): Rendering mode (e.g., &#34;human&#34;, &#34;rgb_array&#34;, &#34;ansi&#34;).

        Examples:
            &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
        &#34;&#34;&#34;
        super().__init__(env_name, num_envs=num_envs, seed=seed)

        if num_envs &gt; 1:
            self._env = gym.make_vec(env_name, num_envs=num_envs, render_mode=render_mode, vectorization_mode=&#34;sync&#34;)
        else:
            self._env = gym.make(env_name, render_mode=render_mode)
        # self._env = BipedalRobotEnv()

        self.action_var = action_var
        self._render_mode = render_mode
        self._env.reset(seed=seed)

        self._num_envs = num_envs
        self._observation_space = self._env.observation_space
        self._action_space = self._env.action_space
        self._is_discrete = isinstance(self._env.action_space, Discrete)

    def reset(self, **kwargs: dict[str, Any]) -&gt; tuple[torch.Tensor, dict[str, Any]]:
        &#34;&#34;&#34;Reset the environment.

        Returns:
            tuple[NDArray[Any], dict[str, Any]]: Observation

        Examples:
            &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
            &gt;&gt;&gt; obs, info = env.reset()
        &#34;&#34;&#34;
        obs, info = self._env.reset(seed=self.seed, options=kwargs)
        return torch.Tensor(obs), info

    def step(self, action: Any) -&gt; tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, dict[str, Any]]:
        &#34;&#34;&#34;Take a step in the environment with support for both discrete and continuous actions.

        Args:
            action (Any): Action to take in the environment.

        Returns:
            tuple[NDArray[Any], NDArray[Any], NDArray[Any], NDArray[Any], dict[str, Any]]: Observation, reward, truncated, terminated, info

        Examples:
            &gt;&gt;&gt; import torch
            &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
            &gt;&gt;&gt; obs, info = env.reset()
            &gt;&gt;&gt; action = torch.Tensor(1)
            &gt;&gt;&gt; obs, reward, truncated, terminated, info = env.step({&#34;a&#34;: torch.argmax(action).item()})
        &#34;&#34;&#34;

        if isinstance(action, dict):
            action = action[self.action_var]

        if isinstance(action, torch.Tensor):
            action = action.detach().cpu().numpy()

        if isinstance(self._env.action_space, Discrete | MultiDiscrete):
            action = np.argmax(action, axis=-1)

        # elif isinstance(self._env.action_space, Box):
        #     action = np.clip(action, self._env.action_space.low, self._env.action_space.high)  # 連続値を制限

        obs, reward, terminated, truncated, info = self._env.step(action)
        return torch.Tensor(obs), torch.Tensor([reward] if isinstance(reward, float | int) else reward).reshape(-1, 1), torch.Tensor([terminated] if isinstance(terminated, bool) else terminated).reshape(-1, 1), torch.Tensor([truncated] if isinstance(truncated, bool) else truncated).reshape(-1, 1), info

    def close(self) -&gt; None:
        &#34;&#34;&#34;Close the environment.

        Examples:
            &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
            &gt;&gt;&gt; env.close()
        &#34;&#34;&#34;
        self._env.close()

    def render(self) -&gt; None:
        &#34;&#34;&#34;Render the environment.

        Examples:
            &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
            &gt;&gt;&gt; env.render()
        &#34;&#34;&#34;
        frames = self._env.render()

        if frames is None:
            return

        if self._render_mode == &#34;rgb_array&#34;:
            plt.cla()
            plt.clf()
            plt.imshow(np.array(frames).mean(axis=0).astype(np.uint8))
            plt.axis(&#34;off&#34;)
            plt.pause(0.01)</code></pre>
</details>
<div class="desc"><p>Standard single Gym environment wrapper.</p>
<p>Initialize the environment.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>env_name</code></strong> :&ensp;<code>str</code></dt>
<dd>Name of the gym environment.</dd>
<dt><strong><code>action_var</code></strong> :&ensp;<code>str</code></dt>
<dd>Name of the action variable.</dd>
<dt><strong><code>seed</code></strong> :&ensp;<code>int</code></dt>
<dd>Random seed for reproducibility.</dd>
<dt><strong><code>render_mode</code></strong> :&ensp;<code>str</code></dt>
<dd>Rendering mode (e.g., "human", "rgb_array", "ansi").</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; env = Env(&quot;CartPole-v1&quot;)
</code></pre></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="pixyzrl.environments.env.BaseEnv" href="#pixyzrl.environments.env.BaseEnv">BaseEnv</a></li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="pixyzrl.environments.env.Env.close"><code class="name flex">
<span>def <span class="ident">close</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def close(self) -&gt; None:
    &#34;&#34;&#34;Close the environment.

    Examples:
        &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
        &gt;&gt;&gt; env.close()
    &#34;&#34;&#34;
    self._env.close()</code></pre>
</details>
<div class="desc"><p>Close the environment.</p>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; env = Env(&quot;CartPole-v1&quot;)
&gt;&gt;&gt; env.close()
</code></pre></div>
</dd>
<dt id="pixyzrl.environments.env.Env.render"><code class="name flex">
<span>def <span class="ident">render</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def render(self) -&gt; None:
    &#34;&#34;&#34;Render the environment.

    Examples:
        &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
        &gt;&gt;&gt; env.render()
    &#34;&#34;&#34;
    frames = self._env.render()

    if frames is None:
        return

    if self._render_mode == &#34;rgb_array&#34;:
        plt.cla()
        plt.clf()
        plt.imshow(np.array(frames).mean(axis=0).astype(np.uint8))
        plt.axis(&#34;off&#34;)
        plt.pause(0.01)</code></pre>
</details>
<div class="desc"><p>Render the environment.</p>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; env = Env(&quot;CartPole-v1&quot;)
&gt;&gt;&gt; env.render()
</code></pre></div>
</dd>
<dt id="pixyzrl.environments.env.Env.reset"><code class="name flex">
<span>def <span class="ident">reset</span></span>(<span>self, **kwargs: dict[str, typing.Any]) ‑> tuple[torch.Tensor, dict[str, typing.Any]]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def reset(self, **kwargs: dict[str, Any]) -&gt; tuple[torch.Tensor, dict[str, Any]]:
    &#34;&#34;&#34;Reset the environment.

    Returns:
        tuple[NDArray[Any], dict[str, Any]]: Observation

    Examples:
        &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
        &gt;&gt;&gt; obs, info = env.reset()
    &#34;&#34;&#34;
    obs, info = self._env.reset(seed=self.seed, options=kwargs)
    return torch.Tensor(obs), info</code></pre>
</details>
<div class="desc"><p>Reset the environment.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple[NDArray[Any], dict[str, Any]]</code></dt>
<dd>Observation</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; env = Env(&quot;CartPole-v1&quot;)
&gt;&gt;&gt; obs, info = env.reset()
</code></pre></div>
</dd>
<dt id="pixyzrl.environments.env.Env.step"><code class="name flex">
<span>def <span class="ident">step</span></span>(<span>self, action: Any) ‑> tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, dict[str, typing.Any]]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def step(self, action: Any) -&gt; tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, dict[str, Any]]:
    &#34;&#34;&#34;Take a step in the environment with support for both discrete and continuous actions.

    Args:
        action (Any): Action to take in the environment.

    Returns:
        tuple[NDArray[Any], NDArray[Any], NDArray[Any], NDArray[Any], dict[str, Any]]: Observation, reward, truncated, terminated, info

    Examples:
        &gt;&gt;&gt; import torch
        &gt;&gt;&gt; env = Env(&#34;CartPole-v1&#34;)
        &gt;&gt;&gt; obs, info = env.reset()
        &gt;&gt;&gt; action = torch.Tensor(1)
        &gt;&gt;&gt; obs, reward, truncated, terminated, info = env.step({&#34;a&#34;: torch.argmax(action).item()})
    &#34;&#34;&#34;

    if isinstance(action, dict):
        action = action[self.action_var]

    if isinstance(action, torch.Tensor):
        action = action.detach().cpu().numpy()

    if isinstance(self._env.action_space, Discrete | MultiDiscrete):
        action = np.argmax(action, axis=-1)

    # elif isinstance(self._env.action_space, Box):
    #     action = np.clip(action, self._env.action_space.low, self._env.action_space.high)  # 連続値を制限

    obs, reward, terminated, truncated, info = self._env.step(action)
    return torch.Tensor(obs), torch.Tensor([reward] if isinstance(reward, float | int) else reward).reshape(-1, 1), torch.Tensor([terminated] if isinstance(terminated, bool) else terminated).reshape(-1, 1), torch.Tensor([truncated] if isinstance(truncated, bool) else truncated).reshape(-1, 1), info</code></pre>
</details>
<div class="desc"><p>Take a step in the environment with support for both discrete and continuous actions.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>action</code></strong> :&ensp;<code>Any</code></dt>
<dd>Action to take in the environment.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple[NDArray[Any], NDArray[Any], NDArray[Any], NDArray[Any], dict[str, Any]]</code></dt>
<dd>Observation, reward, truncated, terminated, info</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; import torch
&gt;&gt;&gt; env = Env(&quot;CartPole-v1&quot;)
&gt;&gt;&gt; obs, info = env.reset()
&gt;&gt;&gt; action = torch.Tensor(1)
&gt;&gt;&gt; obs, reward, truncated, terminated, info = env.step({&quot;a&quot;: torch.argmax(action).item()})
</code></pre></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="pixyzrl.environments.env.BaseEnv" href="#pixyzrl.environments.env.BaseEnv">BaseEnv</a></b></code>:
<ul class="hlist">
<li><code><a title="pixyzrl.environments.env.BaseEnv.action_space" href="#pixyzrl.environments.env.BaseEnv.action_space">action_space</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.env" href="#pixyzrl.environments.env.BaseEnv.env">env</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.is_discrete" href="#pixyzrl.environments.env.BaseEnv.is_discrete">is_discrete</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.num_envs" href="#pixyzrl.environments.env.BaseEnv.num_envs">num_envs</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.observation_space" href="#pixyzrl.environments.env.BaseEnv.observation_space">observation_space</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.render_mode" href="#pixyzrl.environments.env.BaseEnv.render_mode">render_mode</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pixyzrl.environments" href="index.html">pixyzrl.environments</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pixyzrl.environments.env.BaseEnv" href="#pixyzrl.environments.env.BaseEnv">BaseEnv</a></code></h4>
<ul class="two-column">
<li><code><a title="pixyzrl.environments.env.BaseEnv.action_space" href="#pixyzrl.environments.env.BaseEnv.action_space">action_space</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.close" href="#pixyzrl.environments.env.BaseEnv.close">close</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.env" href="#pixyzrl.environments.env.BaseEnv.env">env</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.is_discrete" href="#pixyzrl.environments.env.BaseEnv.is_discrete">is_discrete</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.num_envs" href="#pixyzrl.environments.env.BaseEnv.num_envs">num_envs</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.observation_space" href="#pixyzrl.environments.env.BaseEnv.observation_space">observation_space</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.render" href="#pixyzrl.environments.env.BaseEnv.render">render</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.render_mode" href="#pixyzrl.environments.env.BaseEnv.render_mode">render_mode</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.reset" href="#pixyzrl.environments.env.BaseEnv.reset">reset</a></code></li>
<li><code><a title="pixyzrl.environments.env.BaseEnv.step" href="#pixyzrl.environments.env.BaseEnv.step">step</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pixyzrl.environments.env.BipedalRobotEnv" href="#pixyzrl.environments.env.BipedalRobotEnv">BipedalRobotEnv</a></code></h4>
<ul class="">
<li><code><a title="pixyzrl.environments.env.BipedalRobotEnv.close" href="#pixyzrl.environments.env.BipedalRobotEnv.close">close</a></code></li>
<li><code><a title="pixyzrl.environments.env.BipedalRobotEnv.metadata" href="#pixyzrl.environments.env.BipedalRobotEnv.metadata">metadata</a></code></li>
<li><code><a title="pixyzrl.environments.env.BipedalRobotEnv.render" href="#pixyzrl.environments.env.BipedalRobotEnv.render">render</a></code></li>
<li><code><a title="pixyzrl.environments.env.BipedalRobotEnv.reset" href="#pixyzrl.environments.env.BipedalRobotEnv.reset">reset</a></code></li>
<li><code><a title="pixyzrl.environments.env.BipedalRobotEnv.step" href="#pixyzrl.environments.env.BipedalRobotEnv.step">step</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pixyzrl.environments.env.Env" href="#pixyzrl.environments.env.Env">Env</a></code></h4>
<ul class="">
<li><code><a title="pixyzrl.environments.env.Env.close" href="#pixyzrl.environments.env.Env.close">close</a></code></li>
<li><code><a title="pixyzrl.environments.env.Env.render" href="#pixyzrl.environments.env.Env.render">render</a></code></li>
<li><code><a title="pixyzrl.environments.env.Env.reset" href="#pixyzrl.environments.env.Env.reset">reset</a></code></li>
<li><code><a title="pixyzrl.environments.env.Env.step" href="#pixyzrl.environments.env.Env.step">step</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.5</a>.</p>
</footer>
</body>
</html>
